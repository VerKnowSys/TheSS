{
    "softwareName": "Openvpn",
    "staticPort": 1194,
    "watchPort": false,
    "install": {
        "commands": "sofin get openvpn",
        "expectOutput": "All done"
    },
    "validate": {
        "commands": "
test ! -e SERVICE_PREFIX/ipp.txt && printf '
tallica,10.10.0.2
dmilith,10.10.0.3
wick3d,10.10.0.4
' > SERVICE_PREFIX/ipp.txt

test ! -e SERVICE_PREFIX/service.conf && printf \"
port $(cat SERVICE_PREFIX/.ports/0)
\" > SERVICE_PREFIX/service.conf && printf '
daemon
bind SERVICE_ADDRESS
proto udp
dev tap

ca SERVICE_PREFIX/ca.crt
cert SERVICE_PREFIX/server.crt
key SERVICE_PREFIX/server.key
dh SERVICE_PREFIX/dh1024.pem

server 10.10.0.0 255.255.255.0

# this is necessary for clients to reach clients behind the openvpn gateways:
client-to-client
keepalive 10 120
user nobody
group nobody
persist-key
persist-tun
status SERVICE_PREFIX/service-status.log
log-append SERVICE_PREFIX/service.log
comp-lzo
verb 4
push \"redirect-gateway def1\"
push \"no-reply\"

ifconfig-pool-persist SERVICE_PREFIX/ipp.txt 0
' >> SERVICE_PREFIX/service.conf
"
    },
    "start": {
        "commands": "
printf 'Launching Openvpn\n' >> SERVICE_PREFIX/service.log 2>&1
SERVICE_ROOT/exports/openvpn --config SERVICE_PREFIX/service.conf --writepid SERVICE_PREFIX/service.pid --nice -3 >> SERVICE_PREFIX/service.log 2>&1
test -f /etc/pf.conf && service pf reload && printf 'PF reload finished.\n' >> SERVICE_PREFIX/service.log 2>&1
"
    }
}